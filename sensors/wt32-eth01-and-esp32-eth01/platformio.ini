; PlatformIO Project Configuration File
;
; Heartbeat Sensor for PowerBot
;
; Документація: https://docs.platformio.org/page/projectconf.html

[env:wt32-eth01]
platform = espressif32
board = wt32-eth01
framework = arduino

; Бібліотеки
lib_deps = 
    bblanchon/ArduinoJson@^7.0.0

; Параметри збірки
build_flags =
    -DCORE_DEBUG_LEVEL=3
    -DPB_BOARD_NAME=\"WT32-ETH01\"

; Монітор серійного порту
monitor_speed = 115200
monitor_filters = 
    esp32_exception_decoder

; Швидкість завантаження
; Якщо бачиш "Serial data stream stopped / noise", почни з 115200.
; Коли з'єднання стабільне - можна підняти назад (наприклад 460800).
upload_speed = 115200

; Перезавантаження перед upload
upload_protocol = esptool

; ESP32-ETH01 (common clones): parameters vary between revisions (PHY addr / RMII clock / reset+pwr_en / PHY type).
; This env enables autoconfig and will pick a working profile (see Serial logs).
;
; Build/upload:
;   pio run -e esp32-eth01 -t upload
[env:esp32-eth01]
platform = espressif32
board = esp32dev
framework = arduino

lib_deps =
    bblanchon/ArduinoJson@^7.0.0

build_flags =
    -DCORE_DEBUG_LEVEL=3
    ; ESP32-ETH01 має багато ревізій/клонів з різними:
    ; - PHY address (0/1)
    ; - RMII clock (GPIO0_IN vs GPIO0_OUT vs GPIO17_OUT)
    ; - reset/pwr_en pin (часто GPIO16, інколи взагалі відсутній)
    ;
    ; Тому для цього env вмикаємо автоконфіг, який підбирає робочий профіль
    ; і запам'ятовує його в NVS.
    -DPB_ETH_AUTOCONFIG=1
    ; Якщо плата "нестандартна" — вмикаємо ширший перебір MDC/MDIO під час auto-detect PHY.
    ; Виконується 1 раз за сесію автоконфігу, тому на нормальних платах не впливає.
    -DPB_ETH_AUTOCONFIG_DETECT_WIDE=1
    ; Якщо маркування PHY: `SMSC 8720A` / `LAN8720A` / `Microchip` -> ETH_PHY_LAN8720
    ; Якщо маркування PHY: `IP101` (IC+) -> ETH_PHY_IP101 (alias: TLK110)
    -DPB_ETH_AUTOCONFIG_PREFERRED_PHY=ETH_PHY_LAN8720
    -DPB_BOARD_NAME=\"ESP32-ETH01\"

monitor_speed = 115200
monitor_filters =
    esp32_exception_decoder

upload_speed = 115200
upload_protocol = esptool
